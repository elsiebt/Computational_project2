---
title: "Comp_project2"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(boot)
library(ggplot2)
```

# Problem A

## 1.

Getting a impression of the dataset by making a plot of the cummulative number of disasters as a function of each year.
```{r}
#The x-axis contains the spesific time of an accident
x <- coal$date

#y is the cummulative sum of disasters
y <- rep(1,length(x))
y[1]<-0
y <- cumsum(y)
y[length(x)]<-0

#Plotting
ggplot()+
  geom_line(aes(x=x[1:190],y=y[1:190]))

```
## 2.

The posterior distribution is given by


$$
\begin{aligned}
f(\theta|x)&=f(x|t_1, \lambda_0, \lambda_1,\beta)f(t_1)f(\lambda_0|\beta)f(\lambda_1|\beta)f(\beta)\\
<<<<<<< HEAD
&=exp(-(\lambda_0(t_1-t_0)+\lambda_1(t_2-t_1))(y)
=======
&=\exp(-\lambda_0)
>>>>>>> 7244c086b845a66ec39808e408fc9c94cb0f5d40
\end{aligned}
$$

The full conditionals are
$$
\begin{aligned}
f(t_1|...) &\propto \exp\{-t_1(\lambda_0-\lambda_1)\} \\
f(\lambda_0|...) &\propto \lambda_0^{y_0+1} \exp\{-\lambda_0(\frac{1}{\beta} +t_1-t_0)\} \\
f(\lambda_1|...) &\propto \lambda_1^{y_1+1} \exp\{-\lambda_1(\frac{1}{\beta} +t_2-t_1)\} \\
f(\beta|...) &\propto \frac{1}{\beta^5}\exp\{\frac{1}{\beta}(1+\lambda_0+\lambda_1)\}
\end{aligned}
$$

From this we can see that $f(t_1|...) = \text{Exp}(\theta)$ when $\theta^{-1}=\lambda_0-\lambda_1$. Next $f(\lambda_0|...)=\text{Gamma}(\alpha_0,\beta_0)$ when $\alpha_0=y_0+2$ and $\beta_0^{-1}=1/\beta + t_1 - t_0$, and $f(\lambda_1|...)=\text{Gamma}(\alpha_1,\beta_1)$ when $\alpha_1=y_1+2$ and $\beta_1^{-1}=1/\beta + t_2 - t_1$. The full conditional for $\beta$ har no known distribution. 